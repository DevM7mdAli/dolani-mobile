import { I18nManager } from 'react-native';

import { getLocales } from 'expo-localization';
import i18n from 'i18next';
import { initReactI18next } from 'react-i18next';

/* ── Translation Resources ── */

const resources = {
  en: {
    translation: {
      common: {
        appName: 'Dolani',
        loading: 'Loading…',
        error: 'Something went wrong',
        retry: 'Retry',
        cancel: 'Cancel',
        confirm: 'Confirm',
        search: 'Search',
        back: 'Back',
        available: 'Available',
        busy: 'Busy',
        all: 'All',
        details: 'Details',
        navigate: 'Navigate',
        rooms: 'Rooms',
        members: 'Members',
        poweredBy: 'Powered by Dolani',
      },
      tabs: {
        home: 'Home',
        search: 'Search',
        map: 'Map',
        faculty: 'Faculty',
        settings: 'Settings',
      },
      home: {
        brandName: 'موجِّه الحرم',
        brandSubtitle: 'Campus Navigator',
        currentLocation: 'Current Location',
        sampleLocation: 'Building A, Floor 1',
        emergencyExit: 'Emergency Exit',
        menuSearch: 'Search',
        menuNavigate: 'Navigate',
        menuFaculty: 'Faculty',
        menuMap: 'Map',
        pastActivity: 'Past Activity',
        mockLabName: 'Computer Science Lab',
        mockLabLocation: 'Floor 2, East Wing',
      },
      search: {
        title: 'Search Room',
        placeholder: 'Search for a room, faculty member...',
        roomCount: '{{count}} rooms',
        room: 'Room',
        floor: 'Floor {{floor}}, Building {{building}}',
        lectureHall: 'Lecture Hall',
        computerLab: 'Computer Lab',
        navigateTo: 'Navigate',
      },
      room: {
        title: 'Room Information',
        capacity: 'Capacity: {{count}} students',
        distance: 'Distance: {{meters}}m ({{minutes}} min)',
        facilities: 'Facilities',
        projector: 'Projector',
        computer: 'Computer',
        microphone: 'Microphone',
        wifi: 'Wi-Fi',
        navigateToRoom: 'Navigate to Room',
      },
      faculty: {
        title: 'Faculty Members',
        searchPlaceholder: 'Search for a faculty member...',
        memberCount: '{{count}} faculty members',
        office: 'Office: {{room}}',
        officeHours: 'Office Hours: {{hours}}',
        navigateToOffice: 'Navigate to Office',
        computerScience: 'Computer Science',
        softwareEngineering: 'Software Engineering',
      },
      emergency: {
        title: 'Emergency Mode',
        findExit: 'Find the nearest emergency exit',
        followGreen: 'Follow the green path safely',
        emergencyNumbers: 'Emergency Numbers',
        fire: 'Fire',
        ambulance: 'Ambulance',
        security: 'Security',
        nearestExits: 'Nearest Exits',
        mainExit: 'Main Exit',
        eastEmergencyExit: 'East Emergency Exit',
        closest: 'Closest',
        navigateToExit: 'Navigate to this exit',
        building: 'Building {{name}}',
      },
      settings: {
        title: 'Settings',
        subtitle: 'Preferences & Support',
        generalPreferences: 'General Preferences',
        language: 'Language',
        theme: 'Theme',
        light: 'Light',
        dark: 'Dark',
        navigationPreferences: 'Navigation Preferences',
        avoidElevators: 'Avoid Elevators',
        avoidStairs: 'Avoid Stairs',
        aboutApp: 'About App',
        appVersion: 'App Version',
        support: 'Support',
        privacyPolicy: 'Privacy Policy',
        latest: 'Latest',
      },
      navigation: {
        startNavigation: 'Start Navigation',
        arrived: 'You have arrived!',
        recalculating: 'Recalculating route…',
      },
    },
  },
  ar: {
    translation: {
      common: {
        appName: 'دُلَّني',
        loading: 'جارٍ التحميل…',
        error: 'حدث خطأ ما',
        retry: 'إعادة المحاولة',
        cancel: 'إلغاء',
        confirm: 'تأكيد',
        search: 'بحث',
        back: 'رجوع',
        available: 'متاح',
        busy: 'مشغول',
        all: 'الكل',
        details: 'التفاصيل',
        navigate: 'انتقل',
        rooms: 'الغرف',
        members: 'الأعضاء',
        poweredBy: 'Powered by Dolani',
      },
      tabs: {
        home: 'الرئيسية',
        search: 'البحث',
        map: 'الخريطة',
        faculty: 'الأعضاء',
        settings: 'الإعدادات',
      },
      home: {
        brandName: 'موجِّه الحرم',
        brandSubtitle: 'Campus Navigator',
        currentLocation: 'موقعك الحالي',
        sampleLocation: 'المبنى A، الطابق 1',
        emergencyExit: 'مخرج الطوارئ',
        menuSearch: 'البحث',
        menuNavigate: 'التنقّل',
        menuFaculty: 'الأعضاء',
        menuMap: 'الخريطة',
        pastActivity: 'النشاط السابق',
        mockLabName: 'مختبر علوم الحاسب',
        mockLabLocation: 'الطابق 2، الجناح الشرقي',
      },
      search: {
        title: 'البحث عن غرفة',
        placeholder: 'ابحث عن غرفة، عضو هيئة تدريس...',
        roomCount: '{{count}} غرفة',
        room: 'الغرفة',
        floor: 'الطابق {{floor}}، المبنى {{building}}',
        lectureHall: 'قاعة محاضرات',
        computerLab: 'مختبر حاسب',
        navigateTo: 'انتقل',
      },
      room: {
        title: 'معلومات الغرفة',
        capacity: 'السعة: {{count}} طالب',
        distance: 'المسافة: {{meters}} متر ({{minutes}} دقائق)',
        facilities: 'التجهيزات',
        projector: 'بروجكتور',
        computer: 'حاسوب',
        microphone: 'ميكروفون',
        wifi: 'واي فاي',
        navigateToRoom: 'انتقل إلى الغرفة',
      },
      faculty: {
        title: 'أعضاء هيئة التدريس',
        searchPlaceholder: 'ابحث عن عضو هيئة تدريس...',
        memberCount: '{{count}} أعضاء هيئة تدريس',
        office: 'المكتب: {{room}}',
        officeHours: 'الساعات المكتبية: {{hours}}',
        navigateToOffice: 'انتقل إلى المكتب',
        computerScience: 'علوم الحاسب',
        softwareEngineering: 'هندسة البرمجيات',
      },
      emergency: {
        title: 'وضع الطوارئ',
        findExit: 'ابحث عن أقرب مخرج طوارئ',
        followGreen: 'اتبع المسار الأخضر بأمان',
        emergencyNumbers: 'أرقام الطوارئ',
        fire: 'الحريق',
        ambulance: 'الإسعاف',
        security: 'الأمن',
        nearestExits: 'أقرب المخارج',
        mainExit: 'المخرج الرئيسي',
        eastEmergencyExit: 'مخرج الطوارئ الشرقي',
        closest: 'الأقرب',
        navigateToExit: 'انتقل إلى هذا المخرج',
        building: 'المبنى {{name}}',
      },
      settings: {
        title: 'الإعدادات',
        subtitle: 'التفضيلات والدعم',
        generalPreferences: 'التفضيلات العامة',
        language: 'اللغة',
        theme: 'المظهر',
        light: 'فاتح',
        dark: 'داكن',
        navigationPreferences: 'تفضيلات التنقل',
        avoidElevators: 'تجنب المصاعد',
        avoidStairs: 'تجنب الدرج',
        aboutApp: 'عن التطبيق',
        appVersion: 'إصدار التطبيق',
        support: 'الدعم الفني',
        privacyPolicy: 'سياسة الخصوصية',
        latest: 'الأحدث',
      },
      navigation: {
        startNavigation: 'ابدأ التنقل',
        arrived: 'لقد وصلت!',
        recalculating: 'جارٍ إعادة حساب المسار…',
      },
    },
  },
} as const;

/* ── RTL Support ── */

const deviceLanguage = getLocales()[0]?.languageCode ?? 'en';
const isRTL = deviceLanguage === 'ar';

I18nManager.allowRTL(true);
I18nManager.forceRTL(isRTL);

/* ── i18next Initialization ── */

i18n.use(initReactI18next).init({
  resources,
  lng: deviceLanguage,
  fallbackLng: 'en',
  interpolation: {
    escapeValue: false,
  },
  react: {
    useSuspense: false,
  },
});

export default i18n;
